---------------------

* = 보류
// = 해결

---------------------

[일반버그]
1. 좀비를 2번 죽일시 -HP 값 발생 후 시체를 밟고 움직일 수 있는 버그 발생 (레그돌(물리충돌)은 그대로 가능한 상태)
// 2. 아이템 드랍후 다시 주울때 빈 아이템 생성됨
3. 좀비를 타격시 비정상적으로 날라가는 버그 (그냥 부딪힐 때도 가끔 날라감)
=> 메시 콜리전 프리셋을 'NoCollison'으로 바꾸면 안 날라감 -> 근데 그럼 피격 체크가 가능한가..?
* 4. 좀비 패스파인딩 버그 (벽을 잘 못 돌아감)
// 5. 첫 점프를 하고 나서 스테미나 회복 X (달리기는 잘 됨)
6. 인벤토리 관련 버그들
	// - 빈화면 오른쪽 클릭시 인벤에 있는 아이템 무작위로 착용/해제 됨
	// - 아이템 드래그해서 버릴때 인벤에 닫혀있는 칸으로 드래그해서 버리면 해당칸 검은색에서 흰색으로 변함 (실제로 빈칸이 되지는 않음)
	- 아이템 드래그해서 버릴때 빈화면에서 움직이면 인벤에 있는 아이템들 무작위로 같이 버려짐
	- 아이템 드래그해서 버릴때 드래그 클릭 풀때 그 위치에서 버려지는게 아니라 드래그를 한 시점의 위치에서 버려짐 
	(그래서 드래그를 하고 윗증으로 가서 버린다해도 아래층에 버려짐)
	*** - 무기 아이템 착용이 착용 칸에 제대로 표시가 안되는 버그 -> 다른 아이템을 장비하게 되면 리프레쉬되서 나타남
7. 좀비 되살아나고 사람과 충돌체크가 안되는 버그

---------------------

[아이템 사용 관련 버그들]
// 1. 드링킹 아이템 2번이상 사용시 버그
// 2. 참치캔 사용시 크래쉬
* 3. 드링킹 아이템들 손에 들때 모두 음료수 캔으로 보임
// 4. {?} 출혈 회복용 아이템은 체력이 만땅일때 사용 -> 좀비 한마리 스폰시켜 확인 필요
// 5. 드링킹 아이템을 모두 소진시 다시 3번을 누를 시 크래쉬
6. 아이템 사용도중 아이템 줍기를 하면 애니메이션 캔슬 버그 (이렇게되면 아이템 효과가 바로 시전됨)
// 7. 체력회복 아이템을 한번만 사용했지만 자동으로 두번째로도 사용이 되는 버그 (두번째 이펙트는 그래서 무한 플레이됨 - 실제 회복은 X)
// 8. 체력회복 아이템이 사용되는 도주 강제로 한 번더 사용되어 이펙트가 무한 플레이되는 버그
// 10. 무기를 모두 사용해서 파괴된 후 다시 무기창으로(1번 클릭) 이동할 시에 크래쉬되는 버그 
// 11. 아이템 소진후 다시 해당 아이템 핫키로 이동시 QuickHItem/QuickNWeapon에서 크래쉬 발생
12. 체력 회복 도중 좀비에게 피격 당하면 아이템 사용이 멈추는 버그 
(체력 회복은 멈추고 이펙트는 계속 재생, 프로그래스 바도 정지, 따라서 새로 아이템 사용 X)

+ 체력 회복템도 사용도중 피격시 취소/ 중지를 할지 말지 회의
+ 출혈 아이템도 아이템별 사용시간 변동시킬 지 회의

---------------------

[키 사용]
// 1. 키 사용 애니메이션 필요
2. 키 사용 (8초) 이후 열쇠 열리도록 수정 필요 - 지금은 사용하면 바로 풀림
3. 키 사용 중 피격시 프로그래스 바도 중지되는 기능 필요 (중지되면 프로그래스 바도 다시 숨겨야함)
>>>>>>> 4. 키 사용 중 움직이지 못하게 해야함
5. 키로 문을 열고 나서 프로그래스 바 숨겨야함 (일단 바로 게임 오버되긴 하지만...)

---------------------

[AI관련]
// 1. 좀비 패트롤 점이 장애물 안쪽을 찍어서 좀비가 장애물에 끼는 버그
// 2. 목표지점 처음은 잘가지만 두번째 지정해준 목표지점을 주면 움직임이 멈추는 버그
// 3. 클라 좀비 new Rotation FVector{0.f,0.f,0.f}로 잘 설정했지만 해당 Rotation 벡터가 잘못되었다고 언리얼 강제 종료시키는 버그
// 4. 좀비 시야 검사에서 Send Dectect 패킷을 전송할때 좀비의 인덱스가 순차적이지 않다면 vector out of range 크래쉬가 발생
// (예를 들어 1 2 4 5 이런식으로 좀비 인덱스가 설정되면 무조건 크래쉬 발생)
// (인덱스 0번 꼭 사용해야 함 - 그냥 12345 이런식으로 하면 무조건 크래쉬 발생, 근데 01234 이런식으로 하면 해당 크래쉬는 발생 않하지만 
// 5번 문제로 0번 좀비는 작동이 안됨) => (12345 이렇게 했을때 크래쉬 발생시키는 건 5번! [즉, 맨 마지막 인덱스를 할당 받은 좀비, 나머지 좀비는 문제 없는 듯하다])
// 5. 좀비든 플레이어든 0번 인덱스를 설정하면 오류, 작동이 안되는 버그



// 6. 언리얼 에디터에서 플레이 중지를 하면 크래쉬 발생 (서버는 계속 켜진 상태에서) -> 에러 메세지는 정확히 뭔지 모르겠음
// + 마찬가지로 언리얼 에디터에서 플레이를 중지하고 다시 접속을 시도하면 서버-클라(언리얼) 모두 크래쉬 발생
// + 플레이어 두명 접속이 그래서 안됨!!
// -> 서버는 abort(), 클라는 PlayerController.cpp 에서 좀비 위치 갱신해주는 코드에서 NULL 주소 참조 에러 메세지 띄움
// 7. 가끔씩 서버에서 또 vector out of range 크래쉬 발생 -> 크래쉬 메세지 창 뜨고 나서 BT 완전 정지됨
// => [일종의 데이터 레이스 문제] MoveTo에 path 벡터에서 발생하는 문제라서 TimerThread에서 부르던 걸 좀비 BT 쓰레드로 옮기니 문제는 해결 됨
// 다만, 좀비 BT 작동 인터벌 사이에 MoveTo가 작동을 이제 안하게 되니 path의 중간 노드(방향 전환 하는 지점)에서 경로를 벗어나서 움직임을 계산 할 오류 있으니 해당 오류 수정 필요
// 8. 몇몇 좀비들 어느 순간 부터 움직임이 아예 멈춤 -> 벽이나 장애물에 낀 거 같음 (그 근처에서 멈춤)
// => 이전 A* 버그 그대로 남아 있는 듯 함

9. ZombieSpawnData recv가 지금 안 될때가 있음 (좀비 스폰이 안됨) -> Recv Error 띄움 -> 로그 보면 좀비 이동 위치를 받는데 스폰을 안 시킴, 에러 메세지도 한참뒤에 나옴

// 10. OneGameModeBase.cpp 에서 네비메쉬 정보 저장하는 코드 남아 있던데 이거 삭제? -> 언리얼 킬때마다 파일 저장 코드 돌아가는 거 같음
// -> 일단 주석처리

11. 좀비 많이 스폰시키면 시간이 좀 지나고 어느 순간에 갑자기 언리얼이 플레이 중지됨 (한 8~7분쯤) (크래쉬는 아님) (내 컴퓨터 사양 문제일 수도..)
언리얼 크래쉬도 날 때 있는데 에러 메세지 아래와 같음 (블루 스크린도 떴었음...;;)
=> "LogAudioMixer: Warning: AudioMixerPlatformInterface Timeout [ 5 Seconds] waiting for h/w. InstanceID=1"

// 12. 좀비끼리 충돌체크 안 되고 있음 -> 뭉쳐짐
// *** => 일단 좀비끼리는 충돌체크를 하지 않도록 하자!
* => 대신 좀비가 뮤탈 뭉치기 처럼 하나로 보이게 되서 이거 어떻게 해야 할 지 생각 필요...

// 13. 좀비가 플레이어를 따라갈 때 플레이어가 이동하면 좀비는 움직임이 멈춤

// 14. 좀비 아예 맵 밖으로 나가는 버그 있음;;; (화장실 뒤쪽으로 나감)
// -> 일단 패트롤에서 예외처리
// ***-> A* 테스트를 위해서라도 현재 네비메쉬 맵을 수정할 필요가 있어보임 (맵 자체를 바꾸지 말고 맵 저장용으로 수정하고 찍고 원래대로)
// ***-> 추가로 현재 맵이 너무 어두우니 조명 좀 큰거 달기
// => 지하 1층만 좀 수정 -> 장애물 위치를 수정해서 Nav 메쉬 찍는 점 정중앙에 위치하도록 해서 장애물 위치 Nav 메쉬가 잘 체크할 수 있게
=> 얇은 장애물 (지상1층 선반 등)들 아직 통과해서 지나감;;; -> 더 여유롭게 설정해야 할 듯

// 15. 플레이어가 강제 종료 될 시에 서버가 조금 딜레이 후에 해당 플레이어가 접속이 끊김을 알게됨 
// -> 만약 서버에서 어느 한 플레이어를 지정해서 해당 플레이어를 기준으로 작업을 하는게 있다면 문제가 생길 수 있음 
// (아래 ToDo 리스트에 적힌 11번에 좀비 hp 관리와 같은 경우)
// => 그래서 owner(호스트) 클라가 연결이 잠깐 끊기면 (핑 패킷 1~3번은 그냥 무시하지만 5번 이상부터는) 디스컨넥트 프로그레스 바 띄우고 전체 클라 잠시 대기하도록 
// ** => 그냥 Owner 클라 없앰 -> 좀비가 개별적으로 송수신 처리하게 바꿈 (detect 처럼)

// 16. (클라) 플레이어가 쉬프트만 눌러도 Run 패킷을 보냄 -> 플레이어가 실제로 움직였을때가 아니라
// => 쉬프트를 누른뒤 (뛰기 모드 ON) 실제로 움직여 뛰기 시작하면 Run 패킷 보내도록 수정 

// 17. 플레이어가 피격 당해도 피격 당한 후 움직여야지 그때 플레이어 피격 사실을 서버에서 정보를 받음 (피격 당한 시점에 패킷 보내는 거 추가하기)

18. 에디터에서 플레이어 여러명 스폰 시켜서 돌려보면 에디터의 플레이어(1번)만 좀비가 보이고 나머지 클라 화면에서는 좀비가 안 보임...
***-> 지금 이렇게 테스트 하면 좀비가 여러명 포착하면 제대로 여러명 포착함을 서버에 알려줄 수 있나?
   -> if (Char->GetPlayerId() == 99) 일 때만 Detect 검사를 시행해서 에디터에서 여러 클라 돌리면 결국 1번만 검사하는 거 같음;;
   => 빌드해서 테스트, 확인 필요

// 19. 서버에서 Detect 관련해서 데이터 레이스 생길 우려 있음 (좀비 쓰레드-통신 쓰레드 간에 데이터 레이스)
// -> 송수신 쓰레드에서 클라로부터 Detect 패킷을 수신 받으면 IOCP_CORE 클래스 변수 zombie 벡터에 접근하는데, 이는 다른 쓰레드에서 돌아가는 BT에서도 접근하기 때문에;;
// -> 사실 Detect 뿐만 아니라 Attack이나 다른 송수신 쓰레드와 BT 쓰레드에서 같이 접근하는 변수들에서 모두 데이터 레이스 발생 가능함
// => BT 시작 전에 송수신 쓰레드와 별개로 BT 쓰레드 내에 지역/클래스 변수 하나 만들어서 거기에 Data Race 발생하는 변수 값 할당 받아서 그 변수으로 BT 검사하기

// 20. 속도 빠른 좀비는 고개 돌리기가 부자연스러움 (고개를 자꾸 좌우로 흔듦)

21. 클라 PlayerCharacterController.cpp에서 로그 찍는 얘들 거의 recvPlayerData.PlayerId 를 출력해서 모두 0으로 나옴
-> GameInstance->ClientSocketPtr->GetMyPlayerId() 로 출력해야함

// 22. 죽은 플레이어 시체를 계속 좀비가 공격하는 버그

// 23. 샤우팅 좀비 1마리만 스폰 할 시에 애니메이션이 이상하게 작동하는 버그 (아이들-걷기 애니메이션 스위칭 무한 반복 -> 이전에 고친 버근데;;)
// -> 어차피 2마리 이상 스폰시킬 꺼긴 하니까 상관안해도 되는데;;
// => 이전 코드 주석 처리 안해서 발생했던거임;;
[+] 샤우팅 좀비 그냥 자체적으로도 걷는게 어색해보이긴 함

24. 전반적으로 좀비가 부자연스럽게 움직임
// => 충돌체크 설정 바꿔보기
// => 고개 돌리기 고치기
// => moveto 수정하기

*** 25. BT 작은 오작동 버그들 수정하기
// -> 공격 후 정상적으로 안 움직이고 자꾸 같은 장소 왔다 갔다하는 버그
// -> 왜 서버 bt코드에서 새로운 패트롤 플래그 값을 false로 고정하면 도착하고 멈추는게 아니라 특정 두지점을 계속 왔다갔다 하지?
// => 좀비가 일정구간을 왔다갔다하는데, 목표 지점은 고정인데 목표지점을 도달 못하는 거 같음 (도착 로그가 안 뜸)
// => 아니 도달은 하는데 해당 도착지점에서 왜 멈추지 않고 다른 지점을 이동해서 다시 움직임;;; (새로운 패트롤을 다시 지정 안해주는데)
// => 도착 지점 체크가 제대로 안되고 있었음;; (zombieidx 로만 체크하면 안되고 위치로 체크해야했음)

// -> 잠만 코드 보니까 좀비 detect에서 하위 task(sequence) 실행 도중에 상위 task가 검출되면, 하위 플래그값 초기화 안해주는 거 같은데? 
// => ㅇㅇ 맞음 초기화 작업 필요함
// => ReachFinalDestination에서 모든 플래그값 한번에 초기화 하게 작업함 (도착지점에 도착시에)
* => 혹시 더 있나 확인해야함!

* 26. 지하 2층에 구석 한자리에 (0,0,0) 좌표에 T자 자세 취하는 좀비 뭐지..?
=> 이전 절단에서 쓰던 절차적 메쉬에 필요한 좀비임 

// 27. 지하 2층 같은 경우 차들이 랜덤으로 스폰되기 때문에 nav 맵을 저장하기가 까다롭다...
// -> 차를 먼저 스폰하고 맵을 저장 시키면 될 것 같긴한데...
// => 자동차는 스폰 위치가 고정이라 (키 위치만 랜덤), 차 스폰 먼저 시키고 다시 네비메쉬 찍음

// 28. 샤우팅 좀비 샤우팅 할때 가끔 Niagara 쪽에서 잘못된 메모리 참조 크래쉬 발생할 때 있음

// 29. 좀비 사망 후 시체 상태에서 여전히 움직이는 버그 
// -> 클라에서 좀비 hp 동기화가 이상하게 되고 있음 (서버에서는 아직 피가 남아있는데, 클라에서는 그보다 더 빨리 비정상적으로 피가 닳음)
// -> 그래서 서버에서는 여전히 BT는 돌아가서 시체가 움직이고 공격까지 함

>>>>>>> 30. 'DistanceTo_PlayerInsight is empty' 에러 메세지 계속 뜨는거 조사하기

---------------------

[AI관련 ToDo]
// 1. 좀비 Detect 지금 기능 안되고 있음
// => 기능은 되는 것 같은데, 문제는 플레이어를 포착하고 길을 잘 못찾는 경우가 있어, 플레이어가 가만히 있어도 플레이어를 놓치는 경우가 생김
// 2. 좀비 Attack 하고 결과 반영 => 플레이어 죽으면 다른 플레이어도 해당 플레이어 죽음 확인 
// -> 캐릭터 송수신 패킷에 이미 플레이어 hp 보내고 있고, 언리얼 코드내에서 hp=0 되면 자동으로 죽는 애니메이션 재생시킴
*** 근데 죽는 애니메이션이 잘 안되는 것 같다고 얘기했음 => 확인 필요!
// 3. 서버 좀비 도착지점에 도착하면 도착했다고 로그 쭉 연속으로 찍는거 문제 확인하기 
//	=> SendFinalDesti... 함수가 MoveTo에서 불려서 쓰레드 도는 속도만큼 계속나옴
// 4. 좀비 고개 돌리기
// 5. 서버 좀비BT에서 좀비 로케이션 보내는거 갱신 받기
// 6. 가끔 클라에서 좀비 path 받는 부분에서 NULL 주소 참조 에러 뜸
// 7. 좀비 죽고 나서는 움직이지 않게 수정 ( + 심지어 공격도 함;;)
// 8. 좀비 공격 중에는 이동 멈추기 구현 - 클라, 서버 둘다 구현해야함
// 9. 좀비 시야각 만들어 주기
// 10. 위 [AI관련] 7번 문제에서 MoveTo 함수 수정 필요 
// -> 일단 보류: 지금 BT 자체가 0.1초 텀이여서 1초에 200/300/400을 이동하는 좀비는 결국 현재 우리가 사용중인 네비메쉬의 점사이 간격인 100/50을 넘지 못함 (각 텀마다 20/30/40 이동함)
// 11. 좀비 피격 후 좀비 HP 서버-각 클라들 동기화 작업 ( + 좀비 피격 애니메이션 )
// ***-> 궁금한 점: 다른 플레이어가 좀비 공격하면 여러 클라가 다 공격하게 되서 여러번 좀비 피를 깎지는 않는지 확인 
// -> 클라 하나 지정해서(가장 빠른 인덱스) 해당 클라로만 동기화 작업함
// 12. 좀비 맵정보 다들 다 따로 Load 하지 말고 (파일 불러오기) 전역 변수 하나 만들어서 거기에서 한번만 로드하고 해당변수 이용하기
13. 좀비 패트롤은 굳이 리소스 많이 사용하는 A* 쓰지 말고 그냥 간단하게 주변 움직이게 바꾸기
***-> 좀비 40마리 모두 스폰시켜서 테스트 해보기! => 큰 문제(렉)는 없는데 최적화가 그래도 필요해보임(좀비 약간 버벅임) => 랜덤 패트롤 A* 안쓰는 방향으로
// 14. 좀비 피격시에도 움직임 멈추기 (일종의 경직)
// 15. 좀비 공격시에 플레이어가 이동하면 이동하는 방향으로 몸 틀기
// 16. 좀비 걷는 애니메이션 약아악간 끊기는게 보임 -> 보간 필요해보임 => 0.3초 이상 제자리면 그때 idle 재생
// 17. 좀비 애니메이션 재생 후 이동시에 약간씩 순간이동하는 버그 => 일단 수정했지만 아직 그래도 약간 버벅임 (순간이동은 안함 그래도)
// 18. BT 작동 인터벌 설정	-> 너무 짧게하면 플레이어 따라올 시 플레이어가 이동하면 좀비가 멈추고, 너무 길게하면 뚝뚝 끊임 => MoveTo에 시간 계산 deltaTime으로 변경해서 해결
// 19. 좀비 가끔씩 랜덤 패트롤을 찍을 때 계속 경로를 못 찾아서 "[Error] No path found."  "랜덤 패트롤 지정 실패! 다시 검색!!!" 만 계속 나옴
// -> 이거 이 상태에서는 해당 CheckPath함수가 무한루프 돌기때문에 전체 좀비 BT 멈추니 예외처리를 해줘야함 (몇번만 시도해라 등등)
// 20. FootSound 작업
// 21. 러닝 좀비 구현
// 22. 샤우팅 좀비 구현
// 23. 샤우팅 좀비 샤우팅 할때 플레이어를 바라보고 샤우팅하게
// 샤우팅 고개 돌리기 -> detect 플레이어 인덱스 정보 가지고 있나? => LastSeenPlayer
-> 잘되긴 하는데 다른 클라가 볼때는 LastSeenPlayer가 아직 초기화 안되서 그냥 정면을 바라보게 나오긴 함

---------------------

[좀비 슬라이스]
// 1. 러닝 좀비 슬라이스시 머테리얼 설정이 러닝 좀비만 조금 달라서 메시 적용이 달라 텍스쳐 깨질 때가 있음
// => 수동으로 메시 설정해서 해결함
-> 그래도 아주 레어하게 머리 끝부분만 자르면 메시 어긋 날 때 있음;; (이때는 메시 엘레멘트 수가 3이나오는데 순서가 꼬임 (0번자리에 머리카락이고 1번은 body_M이 되야함))
-> 머리 끝부분만 자를때 말고도 그냥 많이 어긋남;;; 메시 설정이 그냥 너무 않좋은 에셋
// 2. 잘리는 부위 크기가 작으면 weight가 (자동설정됨) 같이 작아서 impulse가 너무 커서 너무 날라가는 (맵 뚫고) 문제 있음
// => weight에 따라 impulse도 자동으로 조절하도록 바꾸기
//*** => random impulse를 줄 수도 있긴 하지만, 그러면 서버와 동기화 작업이 늘어나서;;
3. 잘리는 면이 가끔 생성이 제대로 안될 때 있음 (투명한 부분이 생김) -> 어느 좀비 상관 없이
4. 잘린 부위가 컨벡스가 설정이 안되어서 공중에 떠있을 때 있음 -> 그래서 weight도 0임 (대부분 조금 자를 때 발생)

[+] 잘리면 좀비 시체가 날라가는게 조금 어색함
-> 혹시 스켈레톤 메시에도 슬라이스가 적용되는지 보고 가능하다면 애니메이션 재생시켜보기
(예를 들어, 팔이나 머리 일부분이 잘린다면 몸체는 죽는 애니메이션 재생시키기 (절단 부위는 그대로 날리면서))  

---------------------

[이펙트]

[+] 피 이펙트 벽이나 바닥에 부딪히면 데칼(피 묻히기) 만들어보기
// [+] 힐링 이펙트 생성 위치 조금 수정하기
[+] 지금 피, 샤우팅 이펙트 EndPlay 시기가 애니메이션이랑 붙어있는데, 이거 일정시간 후에 없애든가 벽에 부딪히면 없애게 수정하기
-> 지금 이펙트들 모두 벽, 바닥 뚫고 지나감;;
[+] 샤우팅, 힐링 클래스의  RootComponent로 빈 메시가 정해져 있는데 이거 빈 메시 보다는 실제로 메모리 사용하는 다른 걸로 바꾸기

---------------------

[서버-클라 동기화 버그]

[+] 다른 플레이어가 아이템들 떨구면 해당 아이템 동기화되는지 확인 (바닥에 생성되는지 다른 플레이어들도 보이는지) -> X 필요
[+] 타이머 동기화

---------------------


<추가 고려사항들>

// [+] 왼쪽 화장실 중앙에 안보이는 벽이 있어서 플레이어 이동 막음;;
* [+] 좀비에게 코너에 몰리면 빠져 나갈 수가 없음;; 좀비가 안 밀림
*** => 플레이어와 좀비는 충돌체크를 해제? (x) -> 다시 설정 
* -> 대신 밀치기 만드는거 고려해보기
//    => 추가로 바닥에 떨어진 아이템과도 충돌체크 해제
[+] 로딩 스크린 만들기 -> 좀비 스폰, 플레이어 스폰, 아이템 스폰, 네비메쉬 맵 읽기 등등 체크
// [+] 최적화 작업 => <서버> 플레이어가 존재하는 층만 좀비 BT 돌리기, <클라> 마찬가지로 내가 있는 층만 좀비, 플레이어 객체 작동하게(Tick 돌리기) 
// <서버> 플레이어가 존재하는 층만 좀비 BT 돌리기 -> 이거 안되어 있는거 같음
//[+] 좀비 BT 타게팅 관련
// ***=> 좀비 발소리 듣고 발소리 지점 다 도착 후 만약 이전에 플레이어를 본적이 있다면 그럼 다시 그 쪽으로 이동? 아님 그냥 리셋하고 패트롤?
// => 혹은 샤우팅과 발소리 모두 들었다면 이때는 처리 어떻게? (지금은 샤우팅이 우선 순위이긴 함)
// => 무조건 우선순위 실행시키고 (만약 다른 후순위 task를 진행중이라면 overwrite하기) 리셋시키기로, 그래서 해당 task 끝나면 초기상태에서 다시 bt 실행
// [+] 좀비 시야각 만들어 줘서 플레이어가 좀비 옆으로 빠르게 지나가 시야에서 벗어나면 좀비가 플레이어를 놓칠 수 있음 (->약간 바보처럼 보임)
// => 근데 아마 발소리 듣게 만들어주면 플레이어가 빠르게 지나가도 그때 발소리를 듣고 그쪽으로 고개를 돌리게 되면 다시 괜찮게 보일 수 있을 것 같음
// [+] 네비메쉬 간격 설정 변경으로 인한 성능 차이
//	  간격 (100) 1마리 - 0.001초 / 40 - 0.04 -> 틀릴 수 있음 (디버깅 deltaTime 최소 관측 가능한 시간이 1ms(0.001s)라서)
//    간격 (50)  1마리 - 0.002초 / 40 - 0.08
//	  => Node (정점)은 약 4배 증가함
[+] 공격 메카니즘 수정
*** -> 한번에 공격에 여러 좀비 한번에 같이 타격 가능하게? -> 좀비가 잘 뭉치기 때문에 필요해 보임
* => 어차피 n번 절단하려면 좀비 타격 충돌체크 방식을 아예 고쳐야 하니 나중에 그때 같이 고치는 걸로
[+] 게임 헬퍼/도우미 추가 (테스크 박스, 메세지 창...)
* -> 폰트는 나중에 찾아서 알맞는거 넣기
// [+] 동료 캐릭터 UI에 표시하기
* [+] 채팅기능
* [+] 밀치기
* [+] 컷신 (게임 시작시, 게임 엔딩시)
* [+] 캐릭터 사망 후에 다른 플레이어 관전 할 수 있는 팔로우 캠 만들기
// [+] 로딩창/전환 화면 만들기
// [+] 플레쉬 라이트 및 전반적인 맵 조명 수정
// [+] 카메라 위치 수정
// [+] Nav 액터 이제 지워도 되나? -> 이제 안쓰니까 삭제함

// * [+] 클라이언트 쪽 최적화 
// => 먼저 호스트 클라 없애기 -> 일단 좀비 체력 깍는거만 담당하는데, 해당 방식 바꾸기 (좀비가 보내는게 아니라 무기가 보내게)
// -> 이렇게 되면 호스트 클라 없애기 때문에, 목적지 path가 (0,0,0) 인 좀비들 
// (서버에서 같은 층에 있는 좀비만 path 보내고 있어 다른 층 좀비는 path가 (0,0,0)이 됨)


<게임 사운드>
 * 플레이어 - 발소리, 공격 신음소리, 피격당했을때 신음소리, 죽었을때, (점프할때), 붕대, 드링크 먹는 소리, (스태미나 다 사용시 헉헉->스태미나 바를 깜박이게)
 * 무기 - 휘두를 때 소리, 피격 했을때 (무기마다 다른 소리나게), 무기 내구도 다 닳았을때
 * 아이템 - 주웠을때 / (키 사용 소리)
 * 좀비 - 공격할때, 피격 당했을때, 죽을때, (샤우팅), 플레이어 발견시 소리내기, (부활할때), 절단되고 바닥에 나뒹구는 소리
 * 시스템 - 로비에서 버튼음, 화면 전환 효과음, 인벤토리 열고 닫을때 효과음, 중요아이템 획득시 효과음, 알람음 , 게임 클리어시 엔딩컷 만든다면 (못 만들더라도) 차/헬기 탈출 소리
 * 배경음 - 로비 화면 배경음, 대기실 배경음, 메인 게임 배경음
 
 
<엔딩 점수판>
1. 탈출 방법
2. 탈출 시간
3. 탈출한 사람 / 사망한 사람
4. 탈출시 사용한 열쇠 찾은 사람 (탈출문 연 사람 - 혹시 열쇠를 양도 받을 수 있으니) 
5. 좀비 킬 수 (개인 좀비 킬수 / 제일 많이 좀비 죽인 사람- 킬수) 


<패키징하다 발견한 버그들>
[+] 캐릭터 죽어도 움직여짐
-> 이젠 안나오는데, 그때 패키징 문제였던거 같은데 확실하진 않음 
-> 아니 아직 가능함;; 랜덤인듯
-> 아이템 사용도 다 가능함 (키 사용까지도)
*** => 소방관 캐릭 '담배사'하면 해당 버그들 가능함!!

[+] 캐릭터가 안 죽을 때도 있음
-> 뒤늦게 죽거나 아예 안 죽음 (이상한건 UI에는 죽은게 표기됨)
-> 그래도 내 화면 앞에서 바로 직접 죽는 걸 보면 정상적으로 애니메이션 나오는 거 같음 (->아님 랜덤임;;)

// [+] 캐릭터 선택창 뒤에 배경 빈공간 있음
// 캐릭터 움직임 (애니메이션) 자체가 약간의 렉 (딜레이) 있음
// => 이거 좀비 ai 서버로 옮길 때도 발생했던 유사한 문제인데 -> 애니메이션 전환시에 약간의 전환시 딜레이/보간(0.3초)을 하여 고침
// => 쿨타임 적용해서 해결 (0.3초)

[+] 캐릭터 점프 동기화 안됨
** [+] 좀비 죽음 동기화 안됨 -> 좀비가 해당 플레이어가 없는 위치에 있을때 죽으면 다시 그 층에 갔을때 마지막으로 본 위치에 가만히 서있음

// [+] 각목 충돌체크 안됨

*** [+] 핑 연결 끊김 너무 자주 생김 - 15초로 설정했지만 다시 연결이 되어도 해당 카운터를 초기화(다시 0으로)를 잘 못하는 거 같음

// [+] 좀비 스폰 수 절반으로 줄이기

*** [+] 좀비 죽으면 동기화 일단은 지금은 안되니까 대충 잘리게 만들기
-> 동기화 작업 해야됨!!!
// [+] 좀비 죽일때 => 동기화 피 생성 안됨 (임시 코드 - 절단은 안돼도 애니메이션과 피 생성은 만들어 놨는데...)
// => 로그 찍어서 보니까 다른 클라 플레이어들의 무기들 충돌체크(WeaponBeginOverlap)가 돌아가는 중이네..? -> X onegamemode에서 돌아갔던게 있었음
// => 내가 혹시 해서 '나 자신 플레이어만 검사' 하도록 if (OwnerCharacter->GetPlayerId() != 99) return 코드 넣었는데 작동 X (로그도 안 찍히네??)
// => 이상한건 1번 클라로 하면 해당 버그 발생하고 2번으로 하면 또 괜춘함 (두번의 검사 모두 에디터에서 확인 & 두 클라 모두 로컬)

*** [+] 네비 맵 수정 -> 다시 확인해보기

[+] 게임 종료 후 게임 종료시키는 버튼 추가하기 (또는 재시작 기능 구현하기(?))
[+] 게임 시간 동기화

[+] 캐릭 선택화면에서 플레이어 이름 & 초상화 바껴서 나올때 가끔 있음
-> 방에 들어간 순서가 중요한 거 같음
// [+] 엔딩씬에서 킬 수가 안 맞음 (0으로 나옴)

*** [+] 랜덤하게 아이템, 좀비 스폰 안될때 있음
(사실 플레이어도 스폰 안 될때 있는데 해당 플레이어가 움직이면 이제 패킷을 다시 보내게 되서 만약 해당 플레이어가 생성 안됬어도 움직이면 다시 
패킷 전송받아서 생성이 됨) -> 서버 상태가 안 좋을 수록 더 확연히 발생함

***** [+] 아이템 줍기도 동기화 안될 때 있음 (될때도 있고 안 될때도 있음)
=> 패키징 하면 생기는 문제!!! (에디터는 괜춘) -> 아예 delete item 패킷을 서버로 안보내는 거 같음
=> 다만 키는 에디터에서도 먹어도 안 사라짐 (키를 먹고 서버로 해당키를 먹었다는 걸 알려주는 코드가 아이템 삭제 알려주는 코드랑 꼬인거 같음)
*****  [+] 키 아이템 줍고 UI, 미션창 동기화 X (로컬로하면 될때도 있고 안될때도 있음)
=> 해당 버그 클라에서 서버로 아이템 삭제 패킷 전송 할 때 UI 업데이트 패킷이랑 아이템 삭제 패킷이랑 데이터 레이스 발생해서 생기는 문제같음

// [+] 이미지들 지금 로딩 안됨 -> 캐릭터 초상화, 아이템 초상화 => 패키징 폴더 직접 지정으로 해결 
// (동적으로 생성하는 액터의 경우 패키징이 빠질 수 있다함)
// [+] 인게임 들어가면 fatal error 뜨고 크래쉬 => 힐링 이펙트 tick에서 메모리 초기화 (참조 오류) 안한 객체 사용 있었음
// -> 근데, 왜 패키징에서 인게임 들어가자말자 자동으로 (0,0,0)좌표에서 힐링 이펙트가 생성이 되지..?
// => 캐릭터 생성자에서 힐링 이펙트를 CreateDefaultSubobject로 하위 객체 초기화를 해주고 있는데, 이러니 패키징에서 생성했던거였음 (딱히 필요도 X)
******* => 에디터에서는 보이지 않는 문제들 패키징에서는 나타 날 수 있으니 반드시 중간중간에 패키징 테스트를 진행하자!!!

[+] 레디 창에서 먼저 들어간 플레이어가 먼저 레디 누르면 다음 플레이어 해당 플레이어 레디 먼저 누른거 안보임
[+] 다른 층에서 다른 플레이어가 좀비 죽이면 나중에 해당 층가서 해당 좀비 보면 죽은 위치가 이상함 (생성위치에서 죽어 있음)

[+] 10분 다지나면 게임 실패 띄우기

*** [+] 클라 서버랑 연결 안되어 있으면 에러 메세지 띄우기 -> 윈도우 에러 메세지 띄우는게 가능한가? (['에러'] ip 서버 - ??? 에 연결 할 수 없습니다. <'확인'>)

// [+] 패키징에서 좀비 슬라이스 될 때와 안 될 때가 있음 (대부분 안됨) - 디버그 드로우 라인해서 보면 이상한 위치에 찍힘
// -> 이전 무기의 플레인 정보를 받아오는 코드가 패키징에서는 정상 작동 안되는 거 같음 (각 꼭짓점의 인덱스들 안에 값들이 이상함)

// [+] 어웨이(원격)로 클라 2명 실행하면 2번째 플레이어는 인게임 접속이 안됨 (인게임으로 넘어갈 때 크래쉬(배열 인덱스 잘못된 참조) 발생함)

[+] 회사원 스테미나 좀 늘려주기 (너무 답답함;;)

[+] 로비 채팅 입력칸 글자 색 바꾸기

[+] 미션 완료 할때 텍스트 투명화하게 하지 말고 체크 표시를 띄우던가 색깔을 바꿔서 강조하기

[+] 로딩창 프로그래스 바 실제로 작동하게 만들기 
-> 클라에서는 에셋 로딩 끝나면 플레그 바꿔서 +40%, 좀비, 아이템 서버로 정보 받으면 +20% 이런식으로 만들기

[+] 로딩창에서 인게임 넘어갈때 각 클라들 모두 같이 넘어가게 (서버에서 각 클라 로딩확인 작업 필요)

// [+] 좀비 애니메이션 아직 안고쳐진 거 같음;; -> 코드 보니까 idle 애니메이션 전환 자체를 안함 
-> 고치긴 했는데 지금 좀비 moveto가 이상해서 도착지점에 가만히 멈추질 않음 
(그래도, 따로 서버 콘솔창을 클릭해서 BT 스레드 잠시 멈추게해서 정지하는 애니메이션으로 바뀌는 건 확인함)

// [+] 클라 config.txt랑 서버에서 users.txt gitignore 설정하기 (이름도 좀 바꾸고)

// [+] 안 쓰는 프로젝트나 폴더 삭제 좀 하기;;

[+] 캐릭 선택창에 간단하게 캐릭 특징 띄우기?

// [+] 타격 무기(날붙이X) 좀비 죽일때 피 생성 안됨

[+] 인벤 창도 아이템 장비하는 키 같이 띄워서 알려주면 좋을듯 (인벤 창 여는 버튼도 뭐인지 미리 알려주면 좋을 듯)

>>>>>>> [+] 플레이어 사망 후에도 캡슐 바운딩 박스가 켜져있음 (투명벽)

[+] 플레이어 수 상관 없이 게임 시작 가능하게 바꾸기

[+] 사망한/접속이 끊긴 플레이어가 있다면 해당 플레이어는 빼고 모였을때 엔딩 볼 수 있도록 수정하기

// [+] 플레이어 사망하면 띄우는 메세지 계속 띄워 놓기 그냥 (유다희 처럼)

[+] 메인 메뉴 타이틀 폰트 바꿔주기

[+] 힐링 아이템 이전 아이템 사용 쿨타임으로 사용 못 할 경우 알림 메세지 띄우기

>>>>>>> *** [+] 가끔 어떤 플레이어는 아이템을 바닥에 떨구면 바닥에 남지 않고 걍 사라짐;;(자기 화면에서도 안 보임) (아이템 떨구기 동기화 작업도 필요하긴 함)
-> 이거 0번 클라가 떨구면 항상 1번 플레이어 위치에 떨궈짐 (서버-클라 다 로컬로 해서 문제인지는 봐야함)
[+] => 관련해서 키도 떨구거나 하면 동기화 되도록 수정?

>>>>>>> *** [+] 회복 아이템 사용후 회복 도중에 남아있는 해당 아이템 바닥에 떨구면 크래쉬 발생 -> 패키징에서만 발생하는 문제!
>>>>>>> *** [+] 잉? 이젠 그냥 아이템 떨구면 크래쉬 발생함! (로컬은 문제 없는데 어웨이(원격)으로 하면 발생! "array idx 메모리 참조 에러 띄움")

// [+] 전처리기 디렉티브(preprocessor directives)/ 전처리기 플래그 사용해서 서버 주석 스마트하게 관리하도록 바꾸기

[+] 레디 창에서 레디 누르고 back 했다가 다시 들어가면 이미 ready 상태임 (화면상으로는 ready가 안보이는데 내부적으로는 이미 ready인 상태임)

// [+] 가끔 공격할 때 분명 한번 공격 했는데 좀비가 피격을 두번 당한거 처럼 리액션 할 때있음 (근데 피는 안튀고 체력도 그렇다고 2번 깎이는 건 아닌 거 같음)
// -> 이거 혹시 급하게 중간 데모용으로 피 튀는 거 구현한 부분 때문?

[+] 옥상키 하나만 먹었는데 UI는 둘다 먹었다고 지워 질때 있음
-> 키 하나 먹고 떨궈서 다시 주웠을때

[+] 키 들고 있을때 손에 키 줘고 있는게 보이게 하기

// [+] 갑자기 플레이어 피 달때 있음 (맵에 좀비들을 다른 플레이어가 이미 다 죽였는데 어떻해???!!!!)
// -> 이상한게 출혈 회복 템이 사용 가능하지도 않음 (출혈 상태이지 않을때만 막아놨는데)
// => 좀비 스폰 아예 안하고 테스트 한 번 해보기
// => 그냥 0번 플레이어가 7분대 쯤에 아무 이유없이 피가 달기 시작함 (좀비 다 죽임, 맞은 적 없음, 좀비 있는 층에 있지도 않음)
// ======> 버그 아님!!!! 소방관 캐릭이라 담배 안피워서 피가 닳았던거임 ㅋㅋㅋㅋ
// => 그래도 상태 이상 띄워주기!!!

[+] 플레이어 연결 끊기면 해당 플레이어 객체 삭제(화면에서 없애기?)하기?

[+] 좀비 BT 연결 끊긴 플레이어만 해당 층에 있어도 돌아감 -> 이거 고칠까요? (어차피 연결 끊긴 플레이어는 BT 검사는 제외라서;;)

// [+] 캐릭터 출혈 상태이면 해당 상태를 알려주는 기능 넣기 => 아이콘 & 메세지

[+] 좀비 벽을 뚫을 수 있음 -> 상황: 플레이어가 선반 위에 올라가면 좀비는 선반 앞 유효한 네비메시 점까지 가고 그다음 플레이어 위치까지 
움직일 수 있도록 코드가 구현되어 (유효한 점이 아니더라도) 벽을 뚫는 상황이 나옴

[+] 헬기 떠나고 옥상 키먹으면 실패 뜨는데 밑에서 해당 작업 완료 텍스트가 다시 나타남. 
-> 그리고 옥상키 다 먹으면 실패가 성공으로 바뀌고 알림도 뜸;;
(+ 그리고 그냥 '실패'라고 띄우기 보다는 옥상 탈출 '실패' 이렇게 띄우는 게 좋을 것 같음 - 그리고 해당 방식의 탈출은 타임이 정해진 것도 알려주면 좋을 듯)

[+] 10분 지나도 제대로 안꺼질 때 있음 (좀 지났다가 꺼짐, 아님 한 쪽 클라는 꺼지고 나머지는 안 꺼짐)
=> 그리고 그냥 꺼지는 것 보단 게임 오버 띄우기?
=> 플레이어들 모두 죽어도 게임오버 띄우기

[+] 옥상 키 5분 지나도 사용 가능 & 나갈 수도 있음 (엔딩나옴)

[+] 붕대 아이템 손에 쥐고 있는 상태 동기화 문제 있음 (계속 장비하고 있는 걸 보임 - 무기랑 같이 들고 있고 그럼)

[+] 캐릭 선택 창에서 캐릭 선택 버튼 가끔씩 한번에 입력 안될때 있음
[+] 캐릭 선택 창에서 레디 취소하고 다시 캐릭 선택할 수 있게하는 기능

[+] 아이템 줍는 거리가 좀 엄청남

// [+] 잉 로컬로 2개 했을때 2번 클라에서 크래시 발생 -> 1번 클라가 그저 좀비에게 피격 당했을 때 
// -> 원격으로 2개 돌리면 안 생기는 버그인지 확인 필요
// => BaseCharacter 출혈 이상 메세지를 띄우는 부분에서 메모리 참조 오류 문제 였음;

[+] 현재 캐릭터들 이름 설정이 좀 이상함 -> 모델이랑 이름가 좀 안 맞는 거 같음 
(아이돌은 먼가 좀 이상하고, 소방관은 군복입고 있고, 회사원은 employee보다는 business man이 더 맞을 것 같음...)

// [+] 출혈 지속 시간 끝나면 아이콘도 같이 없애주기 (지혈 회복 안했더라도)
// 궁금한점 -> 출혈 효과 시간 다 지나면 출혈상태 공격력 낮아지는거 이거도 안 사라지나..?
// 만약 그렇게 한다면 아이콘 없앨 필요는 없어보이는데 그럼 출혈 효과 날때랑 끝났을 때 아이콘 표시를 좀 다르게 해야할 것 같음 
// (예를 들어 출혈 주이면 깜빡이게, 출혈 효과 끝나면 그냥 띄우고 -> 추가로 출혈 중이면 메세지로 피가 단다고 알려주고 공격력도 낫아지는 걸 알려주는게 좋을 듯) 
// => 근데, 원래는 지혈 안하면 출혈 계속 되게 했었음!!! -> 그런데! 회복아이템(지혈템 X) 먹으면 출혈이 멈추는 거 같음! ====> 고침!!

[+] 전체적인 캐릭터 애니메이션 동기화 빠진 부분들 수정 -> 지혈, 키 사용, 회복 아이템 사용, 아이템 줍기

*** [+] 던지기 무기 어떻게?? (없앤다면 인벤창에 착용칸 없애거나 비활성화처럼 보이게 처리)

[+] 타격 무기도 특별한 장점 추가해주기 
(좀비를 때리면 스턴이 조금 더 오래 걸린다던가, 밀치기를 만든다면 더 많이 밀치게 <-> 날붙이 무기 장점: 좀비 부활이 더 오래걸림 (부활을 다시 만든다면))

[+] 무기 깨질때 소리 추가

[+] 다른 층에서 죽은 좀비들 그 층으로 이동시 한꺼번에 좀비 사망 사운드가 들림

** [+] 캐릭터 동기화 문제 -> 캐릭터가 무기를 들고 있을때 스탠스가 변하는게 동기화 안 됨 (그냥 가만히 서있는 포즈에서 무기 휘두름)

[+] 아이템 동시에 먹기 시도 => 데이터 레이스 발생 안 하나?

[+] 아이템 떨구기 벽이나 장애물에 딱 붙어서 버리면 다시 주울 수 없게 놓임

*** [+] 플레이어 스폰위치 겹치면 게임 시작시 날라감;;; (지금 랜덤으로 지정하는 느낌임)

>>>>>>> *** [+] 왜 좀비 사망 로그, 직접 죽이는데 직접 죽임이랑 동기화 둘 다 뜨는거지? 


<Note>
- 여기 버그 리스트 정리 좀 하기;;;

- 한 컴퓨터에서 내부적으로 서버-클라를 모두 돌릴 경우 각 클라들 서로 캐릭터 움직임(만!) 정보를 늦게 수신 받음 (에디터 & 패키징 모두!)

// - 근데 지금 플레이어 출혈 효과 동기화 어떻게 되고 있는 거지?  => 그냥 캐릭 체력 변화 생기면 패킷 전송하고 있는 방식임

- 잉 근데 gitignore 설정 해줬는데 /Binaries 폴더 올라가지?

- 옥상키로 자동차 문 열 수 있음 (그렇다고 열리지는 않음)

- 미리 옥상을 열어두면 5분 뒤 헬기 떠난 뒤에도 혹시 나갈수 있나?
-> 있음, 심지어 옥상키 헬기 지난 뒤에도 사용 가능
-> 추가로 이건 아이템 줍기 동기화가 잘 안되서 생기는 문제긴 한데 옥상키1(지하1층 스폰 옥상키)을 두명이 다 먹으면 해당 키로 옥상 문 열기 가능 (옥상키2번 없이)

- 차 문 여러 개 열면 각각 열린 차들 문 위치 모두다 탈출 영역이 되는지?

- 다른 클라 손전등은 동기화 안되고 있음 (항상 켜져있는 상태고, 손전등을 비추는 방향도 고정으로 캐릭이 바라보는 앞임)


- 플레이어 죽을때 애니메이션 재생 안돼고 바운딩 박스도 그대로 남는거 
-> 이거 다른 클라에서는 TakeDamage->PlayDead가 실행 안돼서 생기는 문제인데, 그럼 어디에서 플레이어의 피가 닳면 0이하인지 검사해서
해당 작업을 시켜줄 수 있는 장소가 이미 있나?



<중점연구 분야 남은 기능>
1. n번 절단
2. 절단 부위 다시 합쳐지며 좀비 부활을
3. 플레이어가 바라보는 방향에 따라 캐릭터 무기 휘두르기 조절 가능하게

[+] 절단 동기화는 생각해봐야함...